ARM GAS  C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"eeprom.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.global	switch_submodeEEP
  18              		.section	.bss.switch_submodeEEP,"aw",%nobits
  21              	switch_submodeEEP:
  22 0000 00       		.space	1
  23              		.section	.bss.EEPROM_Write_Counter,"aw",%nobits
  26              	EEPROM_Write_Counter:
  27 0000 00       		.space	1
  28              		.section	.data.EEPROM_Write_Address,"aw"
  29              		.align	2
  32              	EEPROM_Write_Address:
  33 0000 00FC0108 		.word	134347776
  34              		.section	.text.EEPROM_Write,"ax",%progbits
  35              		.align	1
  36              		.global	EEPROM_Write
  37              		.syntax unified
  38              		.thumb
  39              		.thumb_func
  41              	EEPROM_Write:
  42              	.LFB65:
  43              		.file 1 "Core/Src/eeprom.c"
   1:Core/Src/eeprom.c **** #include "eeprom.h"
   2:Core/Src/eeprom.c **** #include "switch.h"
   3:Core/Src/eeprom.c **** 
   4:Core/Src/eeprom.c **** uint8 switch_submodeEEP = 0;
   5:Core/Src/eeprom.c **** static uint8 EEPROM_Write_Counter = 0;
   6:Core/Src/eeprom.c **** static uint32 EEPROM_Write_Address = EEPROM_PAGE127_START;
   7:Core/Src/eeprom.c **** 
   8:Core/Src/eeprom.c **** void EEPROM_Write(void)
   9:Core/Src/eeprom.c **** {
  44              		.loc 1 9 1
  45              		.cfi_startproc
  46              		@ args = 0, pretend = 0, frame = 16
  47              		@ frame_needed = 1, uses_anonymous_args = 0
  48 0000 B0B5     		push	{r4, r5, r7, lr}
  49              	.LCFI0:
  50              		.cfi_def_cfa_offset 16
  51              		.cfi_offset 4, -16
  52              		.cfi_offset 5, -12
  53              		.cfi_offset 7, -8
  54              		.cfi_offset 14, -4
  55 0002 84B0     		sub	sp, sp, #16
ARM GAS  C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s 			page 2


  56              	.LCFI1:
  57              		.cfi_def_cfa_offset 32
  58 0004 00AF     		add	r7, sp, #0
  59              	.LCFI2:
  60              		.cfi_def_cfa_register 7
  10:Core/Src/eeprom.c ****     uint16 data[8] = {0};
  61              		.loc 1 10 12
  62 0006 3B46     		mov	r3, r7
  63 0008 0022     		movs	r2, #0
  64 000a 1A60     		str	r2, [r3]
  65 000c 5A60     		str	r2, [r3, #4]
  66 000e 9A60     		str	r2, [r3, #8]
  67 0010 DA60     		str	r2, [r3, #12]
  11:Core/Src/eeprom.c ****     data[EEPROM_Write_Counter] = switch_submode;
  68              		.loc 1 11 32
  69 0012 1D4B     		ldr	r3, .L5
  70 0014 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  71              		.loc 1 11 9
  72 0016 1D4B     		ldr	r3, .L5+4
  73 0018 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  74              		.loc 1 11 32
  75 001a 92B2     		uxth	r2, r2
  76 001c 5B00     		lsls	r3, r3, #1
  77 001e 1033     		adds	r3, r3, #16
  78 0020 3B44     		add	r3, r3, r7
  79 0022 23F8102C 		strh	r2, [r3, #-16]	@ movhi
  12:Core/Src/eeprom.c ****     /* Unlock to control */
  13:Core/Src/eeprom.c ****     HAL_FLASH_Unlock();
  80              		.loc 1 13 5
  81 0026 FFF7FEFF 		bl	HAL_FLASH_Unlock
  14:Core/Src/eeprom.c **** 
  15:Core/Src/eeprom.c ****     /* Writing data to flash memory */
  16:Core/Src/eeprom.c ****     HAL_FLASH_Program(FLASH_TYPEPROGRAM_HALFWORD, EEPROM_Write_Address, data[EEPROM_Write_Counter])
  82              		.loc 1 16 5
  83 002a 194B     		ldr	r3, .L5+8
  84 002c 1968     		ldr	r1, [r3]
  85              		.loc 1 16 77
  86 002e 174B     		ldr	r3, .L5+4
  87 0030 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  88 0032 5B00     		lsls	r3, r3, #1
  89 0034 1033     		adds	r3, r3, #16
  90 0036 3B44     		add	r3, r3, r7
  91 0038 33F8103C 		ldrh	r3, [r3, #-16]
  92              		.loc 1 16 5
  93 003c 9BB2     		uxth	r3, r3
  94 003e 0022     		movs	r2, #0
  95 0040 1C46     		mov	r4, r3
  96 0042 1546     		mov	r5, r2
  97 0044 2246     		mov	r2, r4
  98 0046 2B46     		mov	r3, r5
  99 0048 0120     		movs	r0, #1
 100 004a FFF7FEFF 		bl	HAL_FLASH_Program
  17:Core/Src/eeprom.c ****     EEPROM_Write_Address += 0x02;
 101              		.loc 1 17 26
 102 004e 104B     		ldr	r3, .L5+8
 103 0050 1B68     		ldr	r3, [r3]
 104 0052 0233     		adds	r3, r3, #2
ARM GAS  C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s 			page 3


 105 0054 0E4A     		ldr	r2, .L5+8
 106 0056 1360     		str	r3, [r2]
  18:Core/Src/eeprom.c **** 
  19:Core/Src/eeprom.c ****     /* Lock flash control register */
  20:Core/Src/eeprom.c ****     HAL_FLASH_Lock();
 107              		.loc 1 20 5
 108 0058 FFF7FEFF 		bl	HAL_FLASH_Lock
  21:Core/Src/eeprom.c ****     EEPROM_Write_Counter++;
 109              		.loc 1 21 25
 110 005c 0B4B     		ldr	r3, .L5+4
 111 005e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 112 0060 0133     		adds	r3, r3, #1
 113 0062 DAB2     		uxtb	r2, r3
 114 0064 094B     		ldr	r3, .L5+4
 115 0066 1A70     		strb	r2, [r3]
  22:Core/Src/eeprom.c ****     if(EEPROM_Write_Counter>7)
 116              		.loc 1 22 28
 117 0068 084B     		ldr	r3, .L5+4
 118 006a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 119              		.loc 1 22 7
 120 006c 072B     		cmp	r3, #7
 121 006e 06D9     		bls	.L4
  23:Core/Src/eeprom.c ****     {
  24:Core/Src/eeprom.c ****         EEPROM_Write_Counter = 0;
 122              		.loc 1 24 30
 123 0070 064B     		ldr	r3, .L5+4
 124 0072 0022     		movs	r2, #0
 125 0074 1A70     		strb	r2, [r3]
  25:Core/Src/eeprom.c ****         EEPROM_Write_Address = EEPROM_PAGE127_START;
 126              		.loc 1 25 30
 127 0076 064B     		ldr	r3, .L5+8
 128 0078 064A     		ldr	r2, .L5+12
 129 007a 1A60     		str	r2, [r3]
  26:Core/Src/eeprom.c ****     }
  27:Core/Src/eeprom.c **** 
  28:Core/Src/eeprom.c ****     return HAL_OK;
 130              		.loc 1 28 12
 131 007c 00BF     		nop
 132              	.L4:
 133 007e 00BF     		nop
  29:Core/Src/eeprom.c **** }
 134              		.loc 1 29 1
 135 0080 1037     		adds	r7, r7, #16
 136              	.LCFI3:
 137              		.cfi_def_cfa_offset 16
 138 0082 BD46     		mov	sp, r7
 139              	.LCFI4:
 140              		.cfi_def_cfa_register 13
 141              		@ sp needed
 142 0084 B0BD     		pop	{r4, r5, r7, pc}
 143              	.L6:
 144 0086 00BF     		.align	2
 145              	.L5:
 146 0088 00000000 		.word	switch_submode
 147 008c 00000000 		.word	EEPROM_Write_Counter
 148 0090 00000000 		.word	EEPROM_Write_Address
 149 0094 00FC0108 		.word	134347776
ARM GAS  C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s 			page 4


 150              		.cfi_endproc
 151              	.LFE65:
 153              		.section	.text.EEPROM_Read,"ax",%progbits
 154              		.align	1
 155              		.global	EEPROM_Read
 156              		.syntax unified
 157              		.thumb
 158              		.thumb_func
 160              	EEPROM_Read:
 161              	.LFB66:
  30:Core/Src/eeprom.c **** void EEPROM_Read(void)
  31:Core/Src/eeprom.c **** {
 162              		.loc 1 31 1
 163              		.cfi_startproc
 164              		@ args = 0, pretend = 0, frame = 24
 165              		@ frame_needed = 1, uses_anonymous_args = 0
 166              		@ link register save eliminated.
 167 0000 80B4     		push	{r7}
 168              	.LCFI5:
 169              		.cfi_def_cfa_offset 4
 170              		.cfi_offset 7, -4
 171 0002 87B0     		sub	sp, sp, #28
 172              	.LCFI6:
 173              		.cfi_def_cfa_offset 32
 174 0004 00AF     		add	r7, sp, #0
 175              	.LCFI7:
 176              		.cfi_def_cfa_register 7
  32:Core/Src/eeprom.c ****     uint16 data[8] = {0,};
 177              		.loc 1 32 12
 178 0006 3B1D     		adds	r3, r7, #4
 179 0008 0022     		movs	r2, #0
 180 000a 1A60     		str	r2, [r3]
 181 000c 5A60     		str	r2, [r3, #4]
 182 000e 9A60     		str	r2, [r3, #8]
 183 0010 DA60     		str	r2, [r3, #12]
 184              	.LBB2:
  33:Core/Src/eeprom.c ****     for(uint8 i = 0; i<8;i++)
 185              		.loc 1 33 15
 186 0012 0023     		movs	r3, #0
 187 0014 FB75     		strb	r3, [r7, #23]
 188              		.loc 1 33 5
 189 0016 10E0     		b	.L8
 190              	.L9:
  34:Core/Src/eeprom.c ****     {
  35:Core/Src/eeprom.c ****        data[i] = *(uint32*)(EEPROM_PAGE127_START+(i*2));
 191              		.loc 1 35 52 discriminator 3
 192 0018 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 193 001a 5B00     		lsls	r3, r3, #1
 194              		.loc 1 35 49 discriminator 3
 195 001c 03F10063 		add	r3, r3, #134217728
 196 0020 03F5FE33 		add	r3, r3, #130048
 197              		.loc 1 35 18 discriminator 3
 198 0024 1A68     		ldr	r2, [r3]
 199              		.loc 1 35 12 discriminator 3
 200 0026 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 201              		.loc 1 35 16 discriminator 3
 202 0028 92B2     		uxth	r2, r2
ARM GAS  C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s 			page 5


 203 002a 5B00     		lsls	r3, r3, #1
 204 002c 1833     		adds	r3, r3, #24
 205 002e 3B44     		add	r3, r3, r7
 206 0030 23F8142C 		strh	r2, [r3, #-20]	@ movhi
  33:Core/Src/eeprom.c ****     for(uint8 i = 0; i<8;i++)
 207              		.loc 1 33 27 discriminator 3
 208 0034 FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 209 0036 0133     		adds	r3, r3, #1
 210 0038 FB75     		strb	r3, [r7, #23]
 211              	.L8:
  33:Core/Src/eeprom.c ****     for(uint8 i = 0; i<8;i++)
 212              		.loc 1 33 5 discriminator 1
 213 003a FB7D     		ldrb	r3, [r7, #23]	@ zero_extendqisi2
 214 003c 072B     		cmp	r3, #7
 215 003e EBD9     		bls	.L9
 216              	.LBE2:
  36:Core/Src/eeprom.c ****     }
  37:Core/Src/eeprom.c ****     
  38:Core/Src/eeprom.c ****     switch_submodeEEP = data[0];
 217              		.loc 1 38 29
 218 0040 BB88     		ldrh	r3, [r7, #4]
 219              		.loc 1 38 23
 220 0042 DAB2     		uxtb	r2, r3
 221 0044 034B     		ldr	r3, .L10
 222 0046 1A70     		strb	r2, [r3]
  39:Core/Src/eeprom.c **** }
 223              		.loc 1 39 1
 224 0048 00BF     		nop
 225 004a 1C37     		adds	r7, r7, #28
 226              	.LCFI8:
 227              		.cfi_def_cfa_offset 4
 228 004c BD46     		mov	sp, r7
 229              	.LCFI9:
 230              		.cfi_def_cfa_register 13
 231              		@ sp needed
 232 004e 80BC     		pop	{r7}
 233              	.LCFI10:
 234              		.cfi_restore 7
 235              		.cfi_def_cfa_offset 0
 236 0050 7047     		bx	lr
 237              	.L11:
 238 0052 00BF     		.align	2
 239              	.L10:
 240 0054 00000000 		.word	switch_submodeEEP
 241              		.cfi_endproc
 242              	.LFE66:
 244              		.section	.text.EEPROM_Erase,"ax",%progbits
 245              		.align	1
 246              		.global	EEPROM_Erase
 247              		.syntax unified
 248              		.thumb
 249              		.thumb_func
 251              	EEPROM_Erase:
 252              	.LFB67:
  40:Core/Src/eeprom.c **** 
  41:Core/Src/eeprom.c **** void EEPROM_Erase(void)
  42:Core/Src/eeprom.c **** {
ARM GAS  C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s 			page 6


 253              		.loc 1 42 1
 254              		.cfi_startproc
 255              		@ args = 0, pretend = 0, frame = 32
 256              		@ frame_needed = 1, uses_anonymous_args = 0
 257 0000 80B5     		push	{r7, lr}
 258              	.LCFI11:
 259              		.cfi_def_cfa_offset 8
 260              		.cfi_offset 7, -8
 261              		.cfi_offset 14, -4
 262 0002 88B0     		sub	sp, sp, #32
 263              	.LCFI12:
 264              		.cfi_def_cfa_offset 40
 265 0004 00AF     		add	r7, sp, #0
 266              	.LCFI13:
 267              		.cfi_def_cfa_register 7
  43:Core/Src/eeprom.c ****     uint32_t SectorError = 0;
 268              		.loc 1 43 14
 269 0006 0023     		movs	r3, #0
 270 0008 3B61     		str	r3, [r7, #16]
  44:Core/Src/eeprom.c ****     
  45:Core/Src/eeprom.c ****     /* Unlock to control */
  46:Core/Src/eeprom.c ****     HAL_FLASH_Unlock();
 271              		.loc 1 46 5
 272 000a FFF7FEFF 		bl	HAL_FLASH_Unlock
  47:Core/Src/eeprom.c ****     
  48:Core/Src/eeprom.c ****     /* Calculate sector index */
  49:Core/Src/eeprom.c ****     uint32_t UserAddress = EEPROM_PAGE127_START;
 273              		.loc 1 49 14
 274 000e 0F4B     		ldr	r3, .L16
 275 0010 FB61     		str	r3, [r7, #28]
  50:Core/Src/eeprom.c ****     uint32_t NbOfSectors = 1;
 276              		.loc 1 50 14
 277 0012 0123     		movs	r3, #1
 278 0014 BB61     		str	r3, [r7, #24]
  51:Core/Src/eeprom.c ****     
  52:Core/Src/eeprom.c ****     /* Erase sectors */
  53:Core/Src/eeprom.c ****     FLASH_EraseInitTypeDef EraseInitStruct;
  54:Core/Src/eeprom.c ****     EraseInitStruct.TypeErase = FLASH_TYPEERASE_PAGES;
 279              		.loc 1 54 31
 280 0016 0023     		movs	r3, #0
 281 0018 3B60     		str	r3, [r7]
  55:Core/Src/eeprom.c ****     EraseInitStruct.PageAddress = UserAddress;
 282              		.loc 1 55 33
 283 001a FB69     		ldr	r3, [r7, #28]
 284 001c BB60     		str	r3, [r7, #8]
  56:Core/Src/eeprom.c ****     EraseInitStruct.NbPages = NbOfSectors;
 285              		.loc 1 56 29
 286 001e BB69     		ldr	r3, [r7, #24]
 287 0020 FB60     		str	r3, [r7, #12]
  57:Core/Src/eeprom.c ****     
  58:Core/Src/eeprom.c ****     if(HAL_FLASHEx_Erase(&EraseInitStruct, &SectorError) != HAL_OK)
 288              		.loc 1 58 8
 289 0022 07F11002 		add	r2, r7, #16
 290 0026 3B46     		mov	r3, r7
 291 0028 1146     		mov	r1, r2
 292 002a 1846     		mov	r0, r3
 293 002c FFF7FEFF 		bl	HAL_FLASHEx_Erase
ARM GAS  C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s 			page 7


 294 0030 0346     		mov	r3, r0
 295              		.loc 1 58 7
 296 0032 002B     		cmp	r3, #0
 297 0034 03D0     		beq	.L13
 298              	.LBB3:
  59:Core/Src/eeprom.c ****     { 
  60:Core/Src/eeprom.c ****         uint32_t errorcode = HAL_FLASH_GetError();            
 299              		.loc 1 60 30
 300 0036 FFF7FEFF 		bl	HAL_FLASH_GetError
 301 003a 7861     		str	r0, [r7, #20]
  61:Core/Src/eeprom.c ****         return HAL_ERROR;
 302              		.loc 1 61 16
 303 003c 02E0     		b	.L12
 304              	.L13:
 305              	.LBE3:
  62:Core/Src/eeprom.c ****     }
  63:Core/Src/eeprom.c ****     
  64:Core/Src/eeprom.c ****     /* Lock flash control register */
  65:Core/Src/eeprom.c ****     HAL_FLASH_Lock();
 306              		.loc 1 65 5
 307 003e FFF7FEFF 		bl	HAL_FLASH_Lock
  66:Core/Src/eeprom.c ****     
  67:Core/Src/eeprom.c ****     return HAL_OK;   
 308              		.loc 1 67 12
 309 0042 00BF     		nop
 310              	.L12:
  68:Core/Src/eeprom.c **** }
 311              		.loc 1 68 1
 312 0044 2037     		adds	r7, r7, #32
 313              	.LCFI14:
 314              		.cfi_def_cfa_offset 8
 315 0046 BD46     		mov	sp, r7
 316              	.LCFI15:
 317              		.cfi_def_cfa_register 13
 318              		@ sp needed
 319 0048 80BD     		pop	{r7, pc}
 320              	.L17:
 321 004a 00BF     		.align	2
 322              	.L16:
 323 004c 00FC0108 		.word	134347776
 324              		.cfi_endproc
 325              	.LFE67:
 327              		.text
 328              	.Letext0:
 329              		.file 2 "d:\\3.tools\\arm_gcc_toolchain\\arm-none-eabi\\include\\machine\\_default_types.h"
 330              		.file 3 "d:\\3.tools\\arm_gcc_toolchain\\arm-none-eabi\\include\\sys\\_stdint.h"
 331              		.file 4 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_flash_ex.h"
 332              		.file 5 "Core/Inc/vardef.h"
 333              		.file 6 "Core/Inc/eeprom.h"
 334              		.file 7 "Core/Inc/switch.h"
 335              		.file 8 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal_def.h"
ARM GAS  C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s 			page 8


DEFINED SYMBOLS
                            *ABS*:00000000 eeprom.c
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:21     .bss.switch_submodeEEP:00000000 switch_submodeEEP
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:22     .bss.switch_submodeEEP:00000000 $d
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:26     .bss.EEPROM_Write_Counter:00000000 EEPROM_Write_Counter
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:27     .bss.EEPROM_Write_Counter:00000000 $d
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:29     .data.EEPROM_Write_Address:00000000 $d
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:32     .data.EEPROM_Write_Address:00000000 EEPROM_Write_Address
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:35     .text.EEPROM_Write:00000000 $t
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:41     .text.EEPROM_Write:00000000 EEPROM_Write
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:146    .text.EEPROM_Write:00000088 $d
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:154    .text.EEPROM_Read:00000000 $t
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:160    .text.EEPROM_Read:00000000 EEPROM_Read
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:240    .text.EEPROM_Read:00000054 $d
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:245    .text.EEPROM_Erase:00000000 $t
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:251    .text.EEPROM_Erase:00000000 EEPROM_Erase
C:\Users\jisu8\AppData\Local\Temp\ccSsIjYs.s:323    .text.EEPROM_Erase:0000004c $d

UNDEFINED SYMBOLS
HAL_FLASH_Unlock
HAL_FLASH_Program
HAL_FLASH_Lock
switch_submode
HAL_FLASHEx_Erase
HAL_FLASH_GetError
